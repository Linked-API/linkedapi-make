[
  {
    "url": "/execute",
    "method": "POST",
    "body": {
      "operationName": "checkConnectionStatus",
      "data": {
        "personUrl": "{{parameters.personUrl}}"
      }
    },
    "response": {
      "temp": {
        "workflowId": "{{body.workflowId}}"
      }
    }
  },
  {
    "url": "/status/{{temp.workflowId}}",
    "method": "GET",
    "repeat": {
      "condition": "{{!body.criticalError && body.status !== 'completed'}}",
      "delay": 2000,
      "limit": 1800
    },
    "response": {
      "temp": {
        "status": "{{body.status}}",
        "data": "{{body.data}}",
        "errors": "{{body.errors}}",
        "criticalError": "{{body.criticalError}}"
      }
    }
  },
  {
    "response": {
      "valid": "{{!temp.criticalError && temp.status === 'completed'}}",
      "error": {
        "message": "{{(temp.criticalError && (temp.criticalError.message || temp.criticalError)) || 'Workflow timed out'}}"
      },
      "output": {
        "data": "{{temp.data}}",
        "errors": "{{temp.errors}}"
      }
    }
  }
]
